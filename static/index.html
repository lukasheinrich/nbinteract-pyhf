<html>
<head>
  <meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
  <title>Thebe Lab examples</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js">
  </script>

  <script>
      $(function(){
              $(".thebelab-button").addClass("btn");
              $(".thebelab-button").addClass("btn-primary");
              $(".thebelab-button").addClass("btn-sm");
          });
  </script>

  <!-- <script src="https://vega.github.io/vega/vega.min.js"></script> -->

  <!-- Configure and load Thebe !-->
  <script type="text/x-thebe-config">
    {
      bootstrap: true,
      binderOptions: {
        repo: "lukasheinrich/nbinteract-pyhf",
        ref: "master"
      },
      kernelOptions: {
        name: "python3"
      }
    }
  </script>
  <script type="text/javascript"
      src="https://unpkg.com/thebelab@^0.3.0"></script>
  <!-- or to use a local build: -->
  <!-- <script type="text/javascript" src="../lib/index.js"></script> -->

</head>
<body>
  <div class="row">
  <div class="col-md-2"></div>
  <div class="col-md-8 col-md-offset-2">
  <h1>Interactive Exploration of HistFactory Likelihoods in CAP</h1>
  <p>
    Explanation: This example demonstrates the ability to access and visualize likelihoods stored
    e.g. in repositories such as the CERN Analysis Preservation Portal.
  </p>
  <p>
    Instructions: Click the "Run" button. A message with "Waiting for Kernel" should appear, and after 30 seconds or so an interactive visualization of a statistical model built using <code>HistFactory</code> should appear. You can try playing with the controls, which change the value of the parameters of the statistical models. In this model there is a single parameter of interest <code>SigXsecOverSM</code>, which controls the "bump" corresponding to a BSM component of the model, while a number of nuisnace parameters (both shape, and weight variations) control the SM backgrounds.
  </p>
    
  <p>
    Behind the Scenes: When you click "Run", a process in the cloud is started (using <a href="www.mybinder.org">Binder</a>), which retrieves the text files stored in the archive (think: CAP) and constructs the visualization using the Python implementation of <code>HistFactory</code>: <a href="https://github.com/diana-hep/pyhf">pyhf</a>
    
  </p>


  </p>
  <pre data-executable="true" data-language="python" width = "500">
import requests
import pyhfviz

wspace = requests.get('https://gist.githubusercontent.com/lukasheinrich/dd680c74daf9655db5b8d44c2b4e229e/raw/13b38786241fe118f344e6af35767b2cfefb7fc7/wspac').json()

pyhfviz.viz_likelihood(wspace)
  </pre>
  </div>
</div>
</body>
</html>
